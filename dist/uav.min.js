!function(){"use strict";function e(e,n){var r=Array.from(document.querySelectorAll(e));return n&&r.forEach(n),r}function n(n,r){return r?e(n,r):document.querySelector(n)||document.createElement("div")}function r(e,n,r){return Array.prototype[n].apply(e,r)}function t(e){return!e||"object"!=typeof e||e.tagName||e instanceof RegExp}function u(e,n){e[n]&&e[n].forEach(function(e){return e.binding(e)})}function o(e,n){e&&e._uav&&!t(n)&&(Object.keys(e).forEach(function(r){o(e[r],n[r])}),n._uav=e._uav,n._loops=e._loops,e=null)}function a(e){if(t(e)||e._uav)return e;var r={};return Array.isArray(e)&&(r=[],m.defineProp(r,"_loops",[]),_(r,function(){return u(r._uav,0)})),m.defineProp(r,"_uav",{}),m.defineProp(r,"_watch",function(t,i){e[i]=a(t),Object.defineProperty(r,i,{get:function(){if(n.state&&(!r._loops||"0"===i)){var t=n.state;r._uav[i]=r._uav[i]||[],r._uav[i].push(t),n.node._uav.push(function(){r._uav[i]&&r._uav[i].splice(r._uav[i].indexOf(t),1),t=null})}return n.last={vm:r,key:i},e[i]},set:function(t){if(e[i]!==t){var c=t&&t._uav;t=a(t),!c&&e[i]&&e[i]._uav&&o(e[i],t),e[i]=t,r._loops?n._pause||(r._loops.forEach(function(n){return n.replace(e[i],i)}),u(r._uav,0)):u(r._uav,i)}},configurable:!0,enumerable:!0})}),Object.keys(e).forEach(function(n){return r._watch(e[n],n)}),r}function i(e,r){var t=function(e){return function(n){e.checked=r(n.vm,n.ctx).toString()===e.value}};e.push(function(e){return e.el.addEventListener("change",function(){r(e.vm,e.ctx),n.last.vm[n.last.key]=e.el.value,n.last=null}),m.bindStep(t(e.el),e),e})}function c(e,r){var t=function(e){return function(t){var u=r(t.vm,t.ctx);n.state=null,Array.isArray(u)?e.checked=-1!==u.map(String).indexOf(e.value):e.checked=!!u}};e.push(function(e){e.el.addEventListener("change",function(){var t=r(e.vm,e.ctx);if(Array.isArray(t)){var u=t.indexOf(e.el.value);-1===u&&e.el.checked?t.push(e.el.value):-1===u||e.el.checked||t.splice(u,1)}else n.last.vm[n.last.key]=e.el.checked;return n.last=null,e});var u=r(e.vm,e.ctx);if(Array.isArray(u)){var o=function(){return t(e.el)(e)};u._loops.push({add:o,remove:o,replace:o})}return m.bindStep(t(e.el),e)})}function l(e,r){var t=function(e){return function(n){e.value=r(n.vm,n.ctx)}};e.push(function(e){return e.el.addEventListener("input",function(){r(e.vm,e.ctx),n.last.vm[n.last.key]=e.el.value,n.last=null}),m.bindStep(t(e.el),e),e})}function f(e,n){var r=m.stripTags(e.value),t=b(r),u=function(e){return function(n){var u=t(n.vm,n.ctx);r&&e.removeAttribute(r),!1!==u&&(r=!0===u?r:u)&&e.setAttribute(r,"")}};n.push(function(e){return m.bindStep(u(e.el),e)})}function s(e,r){var t=e.value.match(n.expRX),u=t.map(m.stripTags),o=u.map(b),a=e.value,i=e.name.substring(2),c=function(e){return function(n){for(var r=a,c=0;c<o.length;c++){var l=o[c](n.vm,n.ctx);switch(typeof l){case"function":return void(e[i]=l);case"boolean":l=l?u[c]:""}r=r.replace(t[c],l)}e.setAttribute(i,r)}};r.push(function(e){return m.bindStep(c(e.el),e)})}function d(e,n,r){if(0===e.name.indexOf("u-")){switch(e={name:e.name,value:e.value},r.removeAttribute(e.name),e.name){case"u-for":return x(e,n,r);case"u-attr":return f(e,n);case"u-bind":return y(e,n,r)}s(e,n)}else n.push(function(n){return n.el.setAttribute(e.name,e.value),n})}function v(e,n){var r=b(n),t=function(e){return function(n){var t=r(n.vm,n.ctx);if(t&&(t._el||t.tagName)){var u=t._el?t._el:t;u!==e&&m.unbind(e),e.parentNode&&(e.parentNode.replaceChild(u,e),e=u)}else e.textContent=t}};e.push(function(e){var n=document.createTextNode("");return e.el.appendChild(n),m.bindStep(t(n),e)})}function p(e,r){var t=e.textContent.split(n.expRX);if(t.length>1)t.forEach(function(e){if(e.trim()){var t=document.createTextNode(e);e.match(n.expRX)?v(r,m.stripTags(e)):r.push(function(e){return e.el.appendChild(t.cloneNode()),e})}});else{var u=e.textContent;r.push(function(e){return e.el.appendChild(document.createTextNode(u)),e})}}function h(e){var n=[];return n.root=function(){return e.cloneNode()},Array.from(e.attributes).forEach(function(r){d(r,n,e)}),e.value&&d({name:"value",value:e.value},n,e),Array.from(e.childNodes).forEach(function(e){if(3===e.nodeType)p(e,n);else{var r=h(e);n.push(function(e){return e.el.appendChild(m.render(r,e.vm,e.ctx)),e})}}),n}n.all=e;var m={defineProp:function(e,n,r){return Object.defineProperty(e,n,{value:r,configurable:!0,writable:!0,enumerable:!1})},unbind:function(e){e&&e._uav&&(Array.from(e.children).forEach(m.unbind),e._uav.forEach(function(e){return e()}),e=null)},setTag:function(e,r){n.tagRX=new RegExp("(^"+e+"|"+r+"$)","g"),n.expRX=new RegExp("("+e+".*?"+r+")","g")},stripTags:function(e){return e.replace(n.tagRX,"")},bindStep:function(e,r){return n.state=Object.create(r),n.state.binding=e,e(n.state),n.state=null,r},render:function(e,r,t){return n.node=e.root(),m.defineProp(n.node,"_uav",[]),[{vm:r,ctx:t,el:n.node}].concat(e).reduce(function(e,n){return n(e)}).el}},_=function(e,t){m.defineProp(e,"fill",function(u){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;for(n._pause=!0;o<0;)o+=e.length;for(;a<0;)a+=e.length;r(e,"fill",[u,o,a]);for(var i=0;i<a;i++)!function(n){e._watch(u,n),e._loops.forEach(function(e){return e.replace(u,n)})}(i);return t(),delete n._pause,e}),m.defineProp(e,"push",function(){for(var n=arguments.length,u=Array(n),o=0;o<n;o++)u[o]=arguments[o];var a=e.length;r(e,"push",u);for(var i=a;i<a+u.length;i++)!function(n){e._watch(e[n],n),e._loops.forEach(function(r){return r.add(e[n],n)})}(i);return t(),e}),m.defineProp(e,"pop",function(){var n=e.length-1;e._loops.forEach(function(e){return e.remove(n)});var u=r(e,"pop");return t(),u}),m.defineProp(e,"reverse",function(){return r(e,"reverse"),t(),e}),m.defineProp(e,"shift",function(){n._pause=!0;var u=r(e,"shift");return e._loops.forEach(function(n){n.hasIndex?(e.forEach(n.replace),n.remove(e.length)):n.remove(0)}),t(),delete n._pause,u}),m.defineProp(e,"sort",function(n){var u=r(e,"sort",[n]);return t(),u}),m.defineProp(e,"splice",function(){for(var u=arguments.length,o=Array(u),a=0;a<u;a++)o[a]=arguments[a];n._pause=!0;var i=o[0],c=o[1]||0,l=e.length,f=r(e,"splice",o);return e._loops.forEach(function(n){if(n.hasIndex){e.forEach(n.replace);for(var r=l;r>e.length;r--)n.remove(r-1)}else{for(var t=0;t<c;t++)n.remove(i);for(var u=2;u<o.length;u++)n.insert(o[u],i+u-2)}}),e.forEach(e._watch),t(),delete n._pause,f}),m.defineProp(e,"unshift",function(){for(var u=arguments.length,o=Array(u),a=0;a<u;a++)o[a]=arguments[a];return n._pause=!0,r(e,"unshift",o),e._loops.forEach(function(n){n.hasIndex?e.forEach(n.replace):o.forEach(function(e,r){n.insert(e,r)})}),e.forEach(e._watch),t(),delete n._pause,e})},g=function(e,n){var r=n?n.cloneNode():document.createElement("div");return r.innerHTML=e,1!==r.children.length&&console.error("Template must have 1 root node:",e),r.firstElementChild},b=function(e){var r=new Function("with(arguments[0]){with(arguments[1]){return "+e+"}}");return function(t,u){var o=void 0;try{o=r(t,u||{})}catch(r){o="",n.warnings&&console.warn(r,e)}return void 0===o||null===o?"":o}},x=function(e,r,t){var u=m.stripTags(e.value).split(" in "),o=b(u[1]),i=u[0].split(","),c=i[0].trim(),l=i[1]?i[1].trim():null,f=h(t.firstElementChild);t.innerHTML="";var s=function(e){return function(r){function t(e,n){var t=r.ctx?Object.create(r.ctx):{};return t[c]=e,t[l]=n,m.render(f,r.vm,t)}Array.from(e.children).forEach(m.unbind),e.innerHTML="";var u=a(o(r.vm,r.ctx)||[]);n.state=null;var i={hasIndex:l,add:function(n,r){var u=t(n,r);e.appendChild(u)},insert:function(n,r){var u=t(n,r);e.insertBefore(u,e.children[r])},remove:function(n){e.children[n]&&(m.unbind(e.children[n]),e.children[n].remove())},replace:function(n,r){var u=e.children[r],o=t(n,r);u?(m.unbind(u),e.replaceChild(o,u)):e.appendChild(o)}};u._loops.push(i),n.node._uav.push(function(){u._loops.splice(u._loops.indexOf(i),1)}),u.forEach(i.add)}};r.push(function(e){return m.bindStep(s(e.el),e)})},y=function(e,n,r){var t=b(m.stripTags(e.value));switch(r.getAttribute("type")){case"radio":i(n,t);break;case"checkbox":c(n,t);break;default:l(n,t)}};Array.from||(Array.from=function(e){return e?[].slice.call(e):[]}),m.setTag("{","}"),n.component=function(e,r,t){var u=arguments,o=g(e.innerHTML||e);if(!r)return o;var i=h(o);(r=a(r))._el=m.render(i,r),t&&("string"==typeof t&&(t=n(t)),t.tagName&&(n.unbind(t.firstElementChild),t.innerHTML="",t.appendChild(r._el)));for(var c=1;c<arguments.length&&"break"!==function(e){if("function"==typeof u[e])return setTimeout(function(){return u[e](r._el)}),"break"}(c);c++);return r},n.model=a,n.setTag=m.setTag,n.unbind=m.unbind,window.uav=n,"undefined"!=typeof module&&module.exports&&(module.exports=n)}();