"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){function t(e,n){e=Array.from(document.querySelectorAll(e));return n&&e.forEach(n),e}function f(e,n){return n?t(e,n):document.querySelector(e)||document.createElement("div")}f.all=t;var s={defineProp:function(e,n,t){return Object.defineProperty(e,n,{value:t,configurable:!0,writable:!0,enumerable:!1})},unbind:function(e){e&&e._uav&&(Array.from(e.children).forEach(s.unbind),e._uav.forEach(function(e){return e()}),e._uav=null)},setTag:function(e,n){f.tagRX=new RegExp("(^".concat(e,"|").concat(n,"$)"),"g"),f.expRX=new RegExp("(".concat(e,".*?").concat(n,")"),"g")},stripTags:function(e){return e.replace(f.tagRX,"")},bindStep:function(e,n){return((f.state=Object.create(n)).binding=e)(f.state),f.state=null,n},render:function(e,n,t){return f.node=e.root(),s.defineProp(f.node,"_uav",[]),[{vm:n,ctx:t,el:f.node}].concat(e).reduce(function(e,n){return n(e)}).el}};function p(e,n,t){return Array.prototype[n].apply(e,t)}var e=function(i,l){s.defineProp(i,"fill",function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:i.length;for(f._pause=!0;e<0;)e+=i.length;for(;n<0;)n+=i.length;p(i,"fill",[t,e,n]);for(var r=0;r<n;r++)!function(n){i._watch(t,n),i._loops.forEach(function(e){return e.replace(t,n)})}(r);return l(),delete f._pause,i}),s.defineProp(i,"push",function(){for(var e=i.length,n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];p(i,"push",t);for(var o=e;o<e+t.length;o++)!function(n){i._watch(i[n],n),i._loops.forEach(function(e){return e.add(i[n],n)})}(o);return l(),i}),s.defineProp(i,"pop",function(){var n=i.length-1;i._loops.forEach(function(e){return e.remove(n)});var e=p(i,"pop");return l(),e}),s.defineProp(i,"reverse",function(){return p(i,"reverse"),l(),i}),s.defineProp(i,"shift",function(){f._pause=!0;var e=p(i,"shift");return i._loops.forEach(function(e){e.hasIndex?(i.forEach(e.replace),e.remove(i.length)):e.remove(0)}),l(),delete f._pause,e}),s.defineProp(i,"sort",function(e){e=p(i,"sort",[e]);return l(),e}),s.defineProp(i,"splice",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];f._pause=!0;var u=o[0],a=o[1]||0,c=i.length,t=p(i,"splice",o);return i._loops.forEach(function(e){if(e.hasIndex){i.forEach(e.replace);for(var n=c;n>i.length;n--)e.remove(n-1)}else{for(var t=0;t<a;t++)e.remove(u);for(var r=2;r<o.length;r++)e.insert(o[r],u+r-2)}}),i.forEach(i._watch),l(),delete f._pause,t}),s.defineProp(i,"unshift",function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return f._pause=!0,p(i,"unshift",n),i._loops.forEach(function(t){t.hasIndex?i.forEach(t.replace):n.forEach(function(e,n){t.insert(e,n)})}),i.forEach(i._watch),l(),delete f._pause,i})};function u(e){try{return e&&(Object.getPrototypeOf(e)===Object.prototype||Array.isArray(e))}catch(e){return}}function a(e,n){e[n]&&e[n].forEach(function(e){return e.binding(e)})}function d(r){if(!u(r)||r._uav)return r;var o={};return Array.isArray(r)&&(o=[],s.defineProp(o,"_loops",[]),e(o,function(){return a(o._uav,0)})),s.defineProp(o,"_uav",{}),s.defineProp(o,"_watch",function(e,t){r[t]=d(e),Object.defineProperty(o,t,{get:function(){var e;return!f.state||o._loops&&"0"!==t||(e=f.state,o._uav[t]=o._uav[t]||[],-1===o._uav[t].indexOf(e)&&o._uav[t].push(e),f.node._uav.push(function(){o._uav[t]&&o._uav[t].splice(o._uav[t].indexOf(e),1),e=null})),f.last={vm:o,key:t},r[t]},set:function(e){var n;r[t]!==e&&(n=e&&e._uav,e=d(e),!n&&r[t]&&r[t]._uav&&function n(t,r){t&&t._uav&&u(r)&&(Object.keys(t).forEach(function(e){n(t[e],r[e])}),r._uav=t._uav,t=null)}(r[t],e),r[t]=e,o._loops?f._pause||(o._loops.forEach(function(e){return e.replace(r[t],t)}),a(o._uav,0)):a(o._uav,t))},configurable:!0,enumerable:!0})}),Object.keys(r).forEach(function(e){return o._watch(r[e],e)}),o}var o=function(r){var o=new Function("with(arguments[0]){with(arguments[1]){return ".concat(r,"}}"));return function(e,n){var t;try{t=o(e,n||{})}catch(e){t="",console.warn(e,r)}return null==t?"":t}},r=function(e,n,t){var e=s.stripTags(e.value).split(" in "),a=o(e[1]),e=e[0].split(","),c=e[0].trim(),i=e[1]?e[1].trim():null,l=b(t.firstElementChild);t.innerHTML="";n.push(function(e){return s.bindStep((u=e.el,function(r){Array.from(u.children).forEach(s.unbind),u.innerHTML="";var e=d(a(r.vm,r.ctx)||[]);function o(e,n){var t=r.ctx?Object.create(r.ctx):{};return t[c]=e,t[i]=n,s.render(l,r.vm,t)}f.state=null;var n={hasIndex:i,add:function(e,n){n=o(e,n);u.appendChild(n)},insert:function(e,n){e=o(e,n);u.insertBefore(e,u.children[n])},remove:function(e){u.children[e]&&(s.unbind(u.children[e]),u.children[e].remove())},replace:function(e,n){var t=u.children[n],n=o(e,n);t?(s.unbind(t),u.replaceChild(n,t)):u.appendChild(n)}};e._loops.push(n),u._uav.push(function(){e._loops.splice(e._loops.indexOf(n),1)}),e.forEach(n.add)}),e);var u})};function c(e,t){e.push(function(e){var n;return e.el.addEventListener("change",function(){t(e.vm,e.ctx),f.last.vm[f.last.key]=e.el.value,f.last=null}),s.bindStep((n=e.el,function(e){n.checked=t(e.vm,e.ctx).toString()===n.value}),e),e})}function i(e,r){function o(n){return function(e){e=r(e.vm,e.ctx);f.state=null,Array.isArray(e)?n.checked=-1!==e.map(String).indexOf(n.value):n.checked=!!e}}e.push(function(t){t.el.addEventListener("change",function(){var e,n=r(t.vm,t.ctx);return Array.isArray(n)?-1===(e=n.indexOf(t.el.value))&&t.el.checked?n.push(t.el.value):-1===e||t.el.checked||n.splice(e,1):f.last.vm[f.last.key]=t.el.checked,f.last=null,t});var e,n=r(t.vm,t.ctx);return Array.isArray(n)&&(e=function(){return o(t.el)(t)},n._loops.push({add:e,remove:e,replace:e})),s.bindStep(o(t.el),t)})}function l(e,r){e.push(function(e){var t;return e.el.addEventListener("input",function(){r(e.vm,e.ctx),f.last.vm[f.last.key]=e.el.value,f.last=null}),s.bindStep((t=e.el,function(e){var n=t.selectionStart;t.value=r(e.vm,e.ctx);try{t.setSelectionRange(n,n)}catch(e){}}),e),e})}var v=function(e,n,t){e=o(s.stripTags(e.value));switch(t.getAttribute("type")){case"radio":c(n,e);break;case"checkbox":i(n,e);break;default:l(n,e)}};function h(e,n){var t=s.stripTags(e.value),r=o(t);n.push(function(e){return s.bindStep((n=e.el,function(e){e=r(e.vm,e.ctx);t&&n.removeAttribute(t),!1!==e&&(t=!0===e?t:e)&&n.setAttribute(t,"")}),e);var n})}function m(e,n){var u=e.value.match(f.expRX),a=u.map(s.stripTags),c=a.map(o),i=e.value,l=e.name.substring(2);n.push(function(e){return s.bindStep((o=e.el,function(e){for(var n=i,t=0;t<c.length;t++){var r=c[t](e.vm,e.ctx);switch(_typeof(r)){case"function":return void(o[l]=r);case"boolean":r=r?a[t]:""}n=n.replace(u[t],r)}o.setAttribute(l,n)}),e);var o})}function _(n,e,t){if(0===n.name.indexOf("u-")){switch(n={name:n.name,value:n.value},t.removeAttribute(n.name),n.name){case"u-for":return r(n,e,t);case"u-attr":return h(n,e),0;case"u-bind":return v(n,e,t)}m(n,e)}else e.push(function(e){return e.el.setAttribute(n.name,n.value),e})}function y(e,n){var r=o(n);e.push(function(e){var t,n=document.createTextNode("");return e.el.appendChild(n),s.bindStep((t=n,function(e){var n=r(e.vm,e.ctx);n&&(n._el||n.tagName)?((e=n._el?n._el:n)!==t&&s.unbind(t),t.parentNode&&(t.parentNode.replaceChild(e,t),t=e)):(s.unbind(t),t.textContent=n)}),e)})}function b(n){var a=[];return a.root=function(){return n.cloneNode()},Array.from(n.attributes).forEach(function(e){_(e,a,n)}),n.value&&"OPTION"!==n.tagName&&_({name:"value",value:n.value},a,n),Array.from(n.childNodes).forEach(function(e){var n,t,r,o,u;3===e.nodeType?(r=a,1<(u=(t=e).textContent.split(f.expRX)).length?u.forEach(function(e){var n;e.trim()&&(n=document.createTextNode(e),e.match(f.expRX)?y(r,s.stripTags(e)):r.push(function(e){return e.el.appendChild(n.cloneNode()),e}))}):(o=t.textContent,r.push(function(e){return e.el.appendChild(document.createTextNode(o)),e}))):(n=b(e),a.push(function(e){return e.el.appendChild(s.render(n,e.vm,e.ctx)),e}))}),a}Array.from||(Array.from=function(e){return e?[].slice.call(e):[]}),s.setTag("{","}"),f.component=function(e,n,t){var r=arguments,e=function(e,n){n=n?n.cloneNode():document.createElement("div");return n.innerHTML=e,1!==n.children.length&&console.error("Template must have 1 root node:",e),n.firstElementChild}(e.innerHTML||e);if(!n)return e;e=b(e);(n=d(n))._el=s.render(e,n),t&&("string"==typeof t&&(t=f(t)),t.tagName&&(f.unbind(t.firstElementChild),t.innerHTML="",t.appendChild(n._el)));for(var o=1;o<arguments.length;o++){if("break"===function(e){if("function"==typeof r[e])return setTimeout(function(){return r[e](n._el)}),"break"}(o))break}return n},f.model=d,f.setTag=s.setTag,f.unbind=s.unbind,window.uav=f,"undefined"!=typeof module&&module.exports&&(module.exports=f)}();