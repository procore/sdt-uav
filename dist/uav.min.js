!function(){"use strict";function e(e,n){var t=Array.from(document.querySelectorAll(e));return n&&t.forEach(n),t}function n(n,t){return t?e(n,t):document.querySelector(n)||document.createElement("div")}function t(e,n,t){return Array.prototype[n].apply(e,t)}function r(e){return!e||"object"!=typeof e||e.tagName||e instanceof RegExp}function u(e,n){e[n]&&e[n].forEach(function(e){return e.binding(e)})}function o(e,n){e&&e._uav&&!r(n)&&(Object.keys(e).forEach(function(t){o(e[t],n[t])}),n._uav=e._uav,e=null)}function a(e){if(r(e)||e._uav)return e;var t={};return Array.isArray(e)&&(t=[],m.defineProp(t,"_loops",[]),g(t,function(){return u(t._uav,0)})),m.defineProp(t,"_uav",{}),m.defineProp(t,"_watch",function(r,i){e[i]=a(r),Object.defineProperty(t,i,{get:function(){if(n.state&&(!t._loops||"0"===i)){var r=n.state;t._uav[i]=t._uav[i]||[],t._uav[i].push(r),n.node._uav.push(function(){t._uav[i]&&t._uav[i].splice(t._uav[i].indexOf(r),1),r=null})}return n.last={vm:t,key:i},e[i]},set:function(r){if(e[i]!==r){var c=r&&r._uav;r=a(r),!c&&e[i]&&e[i]._uav&&o(e[i],r),e[i]=r,t._loops?(t._loops.forEach(function(n){return n.replace(e[i],i)}),n._pause||u(t._uav,0)):u(t._uav,i)}},configurable:!0,enumerable:!0})}),Object.keys(e).forEach(function(n){return t._watch(e[n],n)}),t}function i(e,t){var r=function(e){return function(n){e.checked=t(n.vm,n.ctx).toString()===e.value}};e.push(function(e){return e.el.addEventListener("change",function(){t(e.vm,e.ctx),n.last.vm[n.last.key]=e.el.value,n.last=null}),m.bindStep(r(e.el),e),e})}function c(e,t){var r=function(e){return function(r){var u=t(r.vm,r.ctx);n.state=null,Array.isArray(u)?e.checked=-1!==u.map(String).indexOf(e.value):e.checked=!!u}};e.push(function(e){e.el.addEventListener("change",function(){var r=t(e.vm,e.ctx);if(Array.isArray(r)){var u=r.indexOf(e.el.value);-1===u&&e.el.checked?r.push(e.el.value):-1===u||e.el.checked||r.splice(u,1)}else n.last.vm[n.last.key]=e.el.checked;return n.last=null,e});var u=t(e.vm,e.ctx);if(Array.isArray(u)){var o=function(){return r(e.el)(e)};u._loops.push({add:o,remove:o,replace:o})}return m.bindStep(r(e.el),e)})}function f(e,t){var r=function(e){return function(n){e.value=t(n.vm,n.ctx)}};e.push(function(e){return e.el.addEventListener("input",function(){t(e.vm,e.ctx),n.last.vm[n.last.key]=e.el.value,n.last=null}),m.bindStep(r(e.el),e),e})}function l(e,n){var t=m.stripTags(e.value),r=b(t),u=function(e){return function(n){var u=r(n.vm,n.ctx);t&&e.removeAttribute(t),!1!==u&&(t=!0===u?t:u)&&e.setAttribute(t,"")}};n.push(function(e){return m.bindStep(u(e.el),e)})}function d(e,t){var r=e.value.match(n.expRX),u=r.map(m.stripTags),o=u.map(b),a=e.value,i=e.name.substring(2),c=function(e){return function(n){for(var t=a,c=0;c<o.length;c++){var f=o[c](n.vm,n.ctx);switch(typeof f){case"function":return void(e[i]=f);case"boolean":f=f?u[c]:""}t=t.replace(r[c],f)}e.setAttribute(i,t)}};t.push(function(e){return m.bindStep(c(e.el),e)})}function s(e,n,t){if(0===e.name.indexOf("u-")){switch(e={name:e.name,value:e.value},t.removeAttribute(e.name),e.name){case"u-for":return y(e,n,t);case"u-attr":return l(e,n);case"u-bind":return x(e,n,t)}d(e,n)}else n.push(function(n){return n.el.setAttribute(e.name,e.value),n})}function v(e,n){var t=b(n),r=function(e){return function(n){var r=t(n.vm,n.ctx);if(r&&(r._el||r.tagName)){var u=r._el?r._el:r;u!==e&&m.unbind(e),e.parentNode&&(e.parentNode.replaceChild(u,e),e=u)}else e.textContent=r}};e.push(function(e){var n=document.createTextNode("");return e.el.appendChild(n),m.bindStep(r(n),e)})}function p(e,t){var r=e.textContent.split(n.expRX);if(r.length>1)r.forEach(function(e){if(e.trim()){var r=document.createTextNode(e);e.match(n.expRX)?v(t,m.stripTags(e)):t.push(function(e){return e.el.appendChild(r.cloneNode()),e})}});else{var u=e.textContent;t.push(function(e){return e.el.appendChild(document.createTextNode(u)),e})}}function h(e){var n=[];return n.root=function(){return e.cloneNode()},Array.from(e.attributes).forEach(function(t){s(t,n,e)}),e.value&&s({name:"value",value:e.value},n,e),Array.from(e.childNodes).forEach(function(e){if(3===e.nodeType)p(e,n);else{var t=h(e);n.push(function(e){return e.el.appendChild(m.render(t,e.vm,e.ctx)),e})}}),n}n.all=e;var m={defineProp:function(e,n,t){return Object.defineProperty(e,n,{value:t,configurable:!0,writable:!0,enumerable:!1})},unbind:function(e){e&&e._uav&&(Array.from(e.children).forEach(m.unbind),e._uav.forEach(function(e){return e()}),e=null)},setTag:function(e,t){n.tagRX=new RegExp("(^"+e+"|"+t+"$)","g"),n.expRX=new RegExp("("+e+".*?"+t+")","g")},stripTags:function(e){return e.replace(n.tagRX,"")},bindStep:function(e,t){return n.state=Object.create(t),n.state.binding=e,e(n.state),n.state=null,t},render:function(e,t,r){return n.node=e.root(),m.defineProp(n.node,"_uav",[]),[{vm:t,ctx:r,el:n.node}].concat(e).reduce(function(e,n){return n(e)}).el}},g=function(e,r){m.defineProp(e,"fill",function(u){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;for(n._pause=!0;o<0;)o+=e.length;for(;a<0;)a+=e.length;t(e,"fill",[u,o,a]);for(var i=e.length;i<a;i++)!function(n){e._watch(u,n),e._loops.forEach(function(e){return e.add(u,n)})}(i);return r(),delete n._pause,e}),m.defineProp(e,"push",function(){for(var n=arguments.length,u=Array(n),o=0;o<n;o++)u[o]=arguments[o];var a=e.length;t(e,"push",u);for(var i=a;i<a+u.length;i++)!function(n){e._watch(e[n],n),e._loops.forEach(function(t){return t.add(e[n],n)})}(i);return r(),e}),m.defineProp(e,"pop",function(){var n=e.length-1;e._loops.forEach(function(e){return e.remove(n)});var u=t(e,"pop");return r(),u}),m.defineProp(e,"reverse",function(){return n._pause=!0,t(e,"reverse"),r(),delete n._pause,e}),m.defineProp(e,"shift",function(){e._loops.forEach(function(e){return e.remove(0)});var n=t(e,"shift");return r(),n}),m.defineProp(e,"sort",function(u){n._pause=!0;var o=t(e,"sort",[u]);return r(),delete n._pause,o}),m.defineProp(e,"splice",function(){for(var u=arguments.length,o=Array(u),a=0;a<u;a++)o[a]=arguments[a];n._pause=!0;for(var i=e.length,c=t(e,"splice",[o.shift(),o.shift()].concat(o)),f=i;f<e.length;f++)!function(n){e._watch(e[n],n),e._loops.forEach(function(t){return t.add(e[n],n)})}(f);for(f=e.length;f<i;f++)!function(n){e._loops.forEach(function(e){return e.remove(n)})}(f);return r(),delete n._pause,c}),m.defineProp(e,"unshift",function(){for(var n=arguments.length,u=Array(n),o=0;o<n;o++)u[o]=arguments[o];var a=e.length;t(e,"unshift",u);for(var i=a;i<e.length;i++)!function(n){e._watch(e[n],n),e._loops.forEach(function(t){return t.add(e[n],n)})}(i);return r(),e})},_=function(e,n){var t=n?n.cloneNode():document.createElement("div");return t.innerHTML=e,1!==t.children.length&&console.error("Template must have 1 root node:",e),t.firstElementChild},b=function(e){var n=new Function("with(arguments[0]){with(arguments[1]){return "+e+"}}");return function(e,t){var r=void 0;try{r=n(e,t||{})}catch(e){r=""}return void 0===r||null===r?"":r}},y=function(e,t,r){var u=m.stripTags(e.value).split(" in "),o=b(u[1]),i=u[0].split(","),c=i[0].trim(),f=i[1]?i[1].trim():null,l=h(r.firstElementChild);r.innerHTML="";var d=function(e){return function(t){function r(e,n){var r=t.ctx?Object.create(t.ctx):{};return r[c]=e,r[f]=n,m.render(l,t.vm,r)}Array.from(e.children).forEach(m.unbind),e.innerHTML="";var u=a(o(t.vm,t.ctx)||[]);n.state=null;var i={add:function(n,t){var u=r(n,t);e.appendChild(u)},remove:function(n){e.children[n]&&(m.unbind(e.children[n]),e.children[n].remove())},replace:function(n,t){var u=e.children[t],o=r(n,t);u?(m.unbind(u),e.replaceChild(o,u)):e.appendChild(o)}};u._loops.push(i),u.forEach(i.add)}};t.push(function(e){return m.bindStep(d(e.el),e)})},x=function(e,n,t){var r=b(m.stripTags(e.value));switch(t.getAttribute("type")){case"radio":i(n,r);break;case"checkbox":c(n,r);break;default:f(n,r)}};Array.from||(Array.from=function(e){return e?[].slice.call(e):[]}),m.setTag("{","}"),n.component=function(e,t,r){var u=arguments,o=_(e.innerHTML||e);if(!t)return o;var i=h(o);(t=a(t))._el=m.render(i,t),r&&("string"==typeof r&&(r=n(r)),r.tagName&&(n.unbind(r.firstElementChild),r.innerHTML="",r.appendChild(t._el)));for(var c=1;c<arguments.length&&"break"!==function(e){if("function"==typeof u[e])return setTimeout(function(){return u[e](t._el)}),"break"}(c);c++);return t},n.model=a,n.setTag=m.setTag,n.unbind=m.unbind,window.uav=n,"undefined"!=typeof module&&module.exports&&(module.exports=n)}();