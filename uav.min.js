'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a};function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}(function(){function a(v,w,x){Object.defineProperty(w,v,{value:function value(){for(var z=arguments.length,y=Array(z),A=0;A<z;A++)y[A]=arguments[A];Array.prototype[v].apply(w,y),x([].concat(_toConsumableArray(w)))},enumerable:!1})}function b(v,w){s.forEach(function(x){return a(x,v,w)})}function c(v,w){var x=w?w.cloneNode():t('div');return x.innerHTML=v,1<x.children.length&&console.error('Components must have only one root node.'),x.firstElementChild}function d(v,w,x){try{return new Function('with(arguments[0]){return '+v+'}').bind(w)(x||w)}catch(y){return'_invalidExpression'}}function f(v){v&&v._gc&&([].concat(_toConsumableArray(v.children)).forEach(f),v._gc.forEach(function(w){return w()}),v._gc=[],v=null)}function g(v){var w=v.noCurlyBraces?[v.template]:v.template.match(/{.*?}/g);if(w){var x=function(y){var z=v.template;w.forEach(function(A){var B=v.noCurlyBraces?A:A.substring(1,A.length-1);y&&(q=x);var C=d(B,v.vm,v.globals);q=null;var D='undefined'==typeof C?'undefined':_typeof(C);z='boolean'===D?z.replace(A,C?B:''):'function'===D||C instanceof Function?C:void 0===C||'_invalidExpression'===C||null===C?z.replace(A,''):'number'===D||'string'===D||C instanceof Number||C instanceof String?z.replace(A,C):'object'===D||C instanceof Object?C._element?C._element:C:z.replace(A,C)}),v.replace(z)};return x(!0),x}}function h(v,w){var x=Array.from(v.attributes).filter(function(y){return y.specified}).map(function(y){return{name:y.name,value:y.value}});x.forEach(function(y){return w(y)}),v.value&&w({name:'value',value:v.value})}function j(v,w,x,y){var z=c(v.innerHTML,v);g({template:w.value,vm:x,globals:y,noCurlyBraces:!0,replace:function replace(A){A=u.model(A),[].concat(_toConsumableArray(v.children)).forEach(f),v.innerHTML='',A.forEach(function(B,C){function D(E){var F=z.cloneNode();F.innerHTML=z.innerHTML,E&&(q=D),v.children[C]?v.replaceChild(n(F,A[C],x),v.children[C]):v.appendChild(n(F,A[C],x)),q=null}D(!0)})}})}function k(v,w,x,y){var z;return'loop'===w.name?(j(v,w,x,y),z=!0):'style'===w.name||'data-style'===w.name?(g({template:w.value,vm:x,globals:y,replace:function replace(A){v.style.cssText=A}}),v.removeAttribute('data-style')):'data-src'===w.name?(g({template:w.value,vm:x,globals:y,replace:function replace(A){v.setAttribute('src',A)}}),v.removeAttribute('data-src')):g({template:w.value,vm:x,globals:y,replace:function replace(A){'function'==typeof A?(v.removeAttribute(w.name),v[w.name]=A):v.setAttribute(w.name,A)}}),z}function l(v,w,x){g({template:v.textContent,vm:w,globals:x,replace:function replace(y){if(y.tagName||y._element){var z=y._element?y._element:y;z!==v&&f(v),v.parentNode.replaceChild(z,v),v=y}else try{v.textContent=y}catch(A){v.innerHTML=''}}})}function m(v,w,x,y){var z=w.tagName.toLowerCase();x[z]!==void 0&&x[z]._element?g({template:z,vm:x,globals:y,replace:function replace(A){w.parentNode===v&&(A!==w&&f(w),w.parentNode.replaceChild(A,w),w=A)},noCurlyBraces:!0}):n(w,x,y)}function n(v,w,x){var y;return(r=v,Object.defineProperty(r,'_gc',{value:[],writable:!0,enumerable:!1}),h(v,function(z){k(v,z,w,x)&&(y=!0)}),y)?v:(Array.from(v.childNodes).forEach(function(z){3===z.nodeType?l(z,w,x):m(v,z,w,x)}),v)}function o(v){return!(!v||'object'!==('undefined'==typeof v?'undefined':_typeof(v))||v.tagName||v._bound)}function p(v,w){v._bound&&w&&(Object.keys(v).forEach(function(x){p(v[x],w[x])}),w._bound=v._bound,v=null)}var q,r,s=['push','pop','reverse','shift','sort','splice','unshift'],t=function(v){return document.createElement(v)},u=window.uav=function(v,w){if(w!==void 0){var x=Array.from(document.querySelectorAll(v));if('function'==typeof w)x.forEach(w);else if('number'==typeof w)return x[w]}else return document.querySelector(v)||t('div')};u.placeholder=function(v){return{_element:t(v||'div')}},u.model=function(v){if(!o(v))return v;var w=Array.isArray(v)?[]:{};return Object.defineProperty(w,'_bound',{value:{},configurable:!0,writable:!0,enumerable:!1}),Object.keys(v).forEach(function(x){function y(B){return o(B)&&(B=u.model(B),Array.isArray(B)&&b(B,A)),B}function A(B){(v[x]!==B||'object'===('undefined'==typeof B?'undefined':_typeof(B)))&&(o(B)?(B=y(B),v[x]&&v[x]._bound&&p(v[x],B),v[x]=B):v[x]=B,w._bound[x]&&(console.info('executing '+w._bound[x].length+' bindings for '+x),w._bound[x].forEach(function(C){return C()})))}v[x]=y(v[x]),Object.defineProperty(w,x,{get:function(){if(q){var B=q;w._bound[x]=w._bound[x]||[],w._bound[x].push(B),r._gc.push(function(){console.info('>>> unbinding '+x);var C=w._bound[x].indexOf(B);w._bound[x].splice(C,1),B=null})}return v[x]},set:A,enumerable:!0,configurable:!0})}),w},u.component=function(v,w,x){var A=arguments;if('string'==typeof v?(v={_element:c(v)},x=w):(v=u.model(v),v._element=n(c(w),v)),'string'==typeof x){var y=u(x),z=y.firstChild;requestAnimationFrame(function(){return f(z)}),y.innerHTML='',y.appendChild(v._element)}for(var _ret,_loop=function(B){if('function'==typeof A[B])return requestAnimationFrame(function(){return A[B](v._element)}),'break'};i<arguments.length&&(_ret=_loop(0),'break'!==_ret);i++);return v},'undefined'!=typeof module&&module.exports&&(module.exports=u)})();